/**
 * SoundJS
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2011 gskinner.com, inc.
 *
 * Distributed under the terms of the MIT license.
 * http://www.opensource.org/licenses/mit-license.html
 *
 * This notice shall be included in all copies or substantial portions of the Software.
 *
 * ver. 1.3.0-3 created from release_v0.2.0
 **/

(function(h){function a(){throw"SoundJS cannot be instantiated";}function f(b,a){this.init(b,a)}function d(){}var c=-1!=navigator.userAgent.indexOf("Firefox")?"ogg":"mp3";a.DELIMITER="|";a.AUDIO_TIMEOUT=8E3;a.INTERRUPT_ANY="any";a.INTERRUPT_EARLY="early";a.INTERRUPT_LATE="late";a.INTERRUPT_NONE="none";a.PLAY_INITED="playInited";a.PLAY_SUCCEEDED="playSucceeded";a.PLAY_INTERRUPTED="playInterrupted";a.PLAY_FINISHED="playFinished";a.PLAY_FAILED="playFailed";a.activePlugin=null;a.muted=!1;a.pluginsRegistered=
!1;a.masterVolume=1;a.muted=!1;a.instances=[];a.instanceHash={};a.idHash=null;a.defaultSoundInstance=null;a.getPreloadHandlers=function(){return{callback:a.proxy(a.initLoad,a),types:["sound"],extensions:["mp3","ogg","wav"]}};a.registerPlugins=function(b){a.pluginsRegistered=!0;for(var c=0,e=b.length;c<e;c++){var g=b[c];if(null!=g&&g.isSupported())return a.activePlugin=new g,!0}return!1};a.registerPlugin=function(b){a.pluginsRegistered=!0;return b.isSupported()?(a.activePlugin=new b,!0):!1};a.isReady=
function(){return null!=a.activePlugin};a.getCapabilities=function(){return a.activePlugin?a.activePlugin.capabilities:null};a.getCapability=function(b){return null==a.activePlugin?null:a.activePlugin.capabilities[b]};a.initLoad=function(b,c,e,g){if(!a.checkPlugin(!0))return!1;b=a.parsePath(b,c,e,g);if(null==b)return!1;null!=e&&(null==a.idHash&&(a.idHash={}),a.idHash[e]=b.src);f.create(b.src,g);e=a.activePlugin.register(b.src,g);if(null!=e&&(null!=e.tag?b.tag=e.tag:e.src&&(b.src=e.src),null!=e.completeHandler))b.handler=
e.completeHandler;return b};a.parsePath=function(b,i,e,g){b=b.split(a.DELIMITER);i={type:i||"sound",id:e,data:g,handler:a.handleSoundReady};a.getCapabilities();for(e=b.length;0<e;)return b=b[0],e=b.lastIndexOf("."),b.substr(e+1).toLowerCase(),e=b.substr(0,e).split("/").pop(),i.name=e,i.src=b,i.extension=c,i;return null};a.play=function(b,i,e,g,k,d,f){"ogg"==c&&(b+="_ogg");if(!a.checkPlugin(!0))return a.defaultSoundInstance;b=a.getSrcFromId(b);b=a.activePlugin.create(b);b.mute(a.muted);a.playInstance(b,
i,e,g,k,d,f)||b.playFailed();return b};a.playInstance=function(b,c,e,g,d,f,h){c=c||a.INTERRUPT_NONE;null==e&&(e=0);null==g&&(g=0);null==d&&(d=0);null==f&&(f=1);null==h&&(h=0);if(0==e){if(!a.beginPlaying(b,c,g,d,f,h))return!1}else setTimeout(function(){a.beginPlaying(b,c,g,d,f,h)},e);this.instances.push(b);this.instanceHash[b.uniqueId]=b;return!0};a.beginPlaying=function(b,a,c,g,d,h){return!f.add(b,a)?!1:!b.beginPlaying(c,g,d,h)?(this.instances.splice(this.instances.indexOf(b),1),delete this.instanceHash[b.uniqueId],
!1):!0};a.checkPlugin=function(b){return null==a.activePlugin&&(b&&!a.pluginsRegistered&&a.registerPlugin(a.HTMLAudioPlugin),null==a.activePlugin)?!1:!0};a.getSrcFromId=function(b){return null==a.idHash||null==a.idHash[b]?b:a.idHash[b]};a.setVolume=function(b,c){if(null==Number(b))return!1;b=Math.max(0,Math.min(1,b));return a.tellAllInstances("setVolume",c,b)};a.getMasterVolume=function(){return a.masterVolume};a.setMasterVolume=function(b){a.masterVolume=b;return a.tellAllInstances("setMasterVolume",
null,b)};a.setMute=function(b){this.muted=b;return a.tellAllInstances("mute",null,b)};a.pause=function(b){return a.tellAllInstances("pause",b)};a.resume=function(b){return a.tellAllInstances("resume",b)};a.stop=function(b){return a.tellAllInstances("stop",b)};a.getInstanceById=function(b){return this.instanceHash[b]};a.playFinished=function(b){f.remove(b);this.instances.splice(this.instances.indexOf(b),1)};a.tellAllInstances=function(b,a,c){if(null==this.activePlugin)return!1;for(var a=this.getSrcFromId(a),
g=this.instances.length-1;0<=g;g--){var d=this.instances[g];if(!(null!=a&&d.src!=a))switch(b){case "pause":d.pause();break;case "resume":d.resume();break;case "setVolume":d.setVolume(c);break;case "setMasterVolume":d.setMasterVolume(c);break;case "mute":d.mute(c);break;case "stop":d.stop();break;case "setPan":d.setPan(c)}}return!0};a.proxy=function(b,a){return function(){return b.apply(a,arguments)}};h.SoundJS=a;f.channels={};f.create=function(b,a){var c=f.get(b);null==c?f.channels[b]=new f(b,a):
c.max+=a};f.add=function(b,a){var c=f.get(b.src);return null==c?!1:c.add(b,a)};f.remove=function(a){var c=f.get(a.src);if(null==c)return!1;c.remove(a);return!0};f.get=function(a){return f.channels[a]};f.prototype={src:null,max:null,length:0,init:function(a,c){this.src=a;this.max=c||1;this.instances=[]},get:function(a){return this.instances[a]},add:function(a,c){if(!this.getSlot(c,a))return!1;this.instances.push(a);this.length++;return!0},remove:function(a){a=this.instances.indexOf(a);if(-1==a)return!1;
this.instances.splice(a,1);this.length--;return!0},getSlot:function(b){for(var c,e,d=0,f=this.max||100;d<f;d++){c=this.get(d);if(null==c)return!0;if(b!=a.INTERRUPT_NONE)if(0==d)e=c;else if(c.playState==a.PLAY_FINISHED||c==a.PLAY_INTERRUPTED||c==a.PLAY_FAILED)e=c;else if(b==a.INTERRUPT_EARLY&&c.getPosition()<e.getPosition()||b==a.INTERRUPT_LATE&&c.getPosition()>e.getPosition())e=c}return null!=e?(e.interrupt(),this.remove(e),!0):!1},toString:function(){return"[SoundJS SoundChannel]"}};a.defaultSoundInstance=
new function(){this.pause=this.resume=this.play=this.beginPlaying=this.cleanUp=this.interrupt=this.stop=this.setMasterVolume=this.setVolume=this.mute=this.setPan=this.getPosition=this.setPosition=this.toString=function(){return!1};this.getVolume=this.getPan=this.getDuration=function(){return 0};this.playState=a.PLAY_FAILED};d.init=function(){var a=navigator.userAgent;d.isFirefox=-1<a.indexOf("Firefox");d.isOpera=null!=h.opera;d.isIOS=-1<a.indexOf("iPod")||-1<a.indexOf("iPhone")||-1<a.indexOf("iPad");
d.isAdobeAIR=-1<a.indexOf("AdobeAIR")||h.navigator.isAIR;d.isAndroid=-1<a.indexOf("Android")};d.init();a.BrowserDetect=d})(window);
(function(h){function a(){this.init()}function f(a){this.init(a)}function d(a){this.init(a)}a.MAX_INSTANCES=30;a.capabilities=null;a.lastId=0;a.AUDIO_READY="canplaythrough";a.AUDIO_ENDED="ended";a.AUDIO_ERROR="error";a.AUDIO_STALLED="stalled";a.fillChannels=!1;a.isSupported=function(){if(SoundJS.BrowserDetect.isAdobeAIR&&SoundJS.BrowserDetect.isAndroid)return!1;a.generateCapabilities();if(a.capabilities.mp3||a.capabilities.ogg||a.capabilities.mpeg||a.capabilities.wav){var c=a.tag;return!(null==c||
null==c.canPlayType)}return!1};a.generateCapabilities=function(){if(null==a.capabilities){var c=a.tag=document.createElement("audio");a.capabilities={panning:!1,volume:!0,mp3:"no"!=c.canPlayType("audio/mp3")&&""!=c.canPlayType("audio/mp3")||"no"!=c.canPlayType("audio/mpeg")&&""!=c.canPlayType("audio/mpeg"),ogg:"no"!=c.canPlayType("audio/ogg")&&""!=c.canPlayType("audio/ogg"),mpeg:"no"!=c.canPlayType("audio/mpeg")&&""!=c.canPlayType("audio/mpeg"),wav:"no"!=c.canPlayType("audio/wav")&&""!=c.canPlayType("audio/wav"),
channels:a.MAX_INSTANCES}}};a.prototype={capabilities:null,FT:0.001,channels:null,init:function(){this.capabilities=a.capabilities;this.channels={}},register:function(a,b){for(var f=d.get(a),e,g=0,h=b||1;g<h;g++)e=this.createTag(a),f.add(e);return{tag:e}},createTag:function(a){var b=document.createElement("audio");b.preload=!1;b.src=a;return b},create:function(a){a=new f(a);a.owner=this;return a},toString:function(){return"[HTMLAudioPlugin]"}};h.SoundJS.HTMLAudioPlugin=a;f.prototype={src:null,uniqueId:-1,
playState:null,owner:null,loaded:!1,lastInterrupt:SoundJS.INTERRUPT_NONE,offset:0,delay:0,volume:1,pan:0,remainingLoops:0,delayTimeout:-1,tag:null,muted:!1,paused:!1,onComplete:null,onLoop:null,onReady:null,onPlayFailed:null,onPlayInterrupted:null,endedHandler:null,readyHandler:null,stalledHandler:null,init:function(c){this.uniqueId=a.lastId++;this.src=c;this.endedHandler=SoundJS.proxy(this.handleSoundComplete,this);this.readyHandler=SoundJS.proxy(this.handleSoundReady,this);this.stalledHandler=SoundJS.proxy(this.handleSoundStalled,
this)},cleanUp:function(){var c=this.tag;if(null!=c){c.pause();try{c.currentTime=0}catch(b){}c.removeEventListener(a.AUDIO_ENDED,this.endedHandler,!1);c.removeEventListener(a.AUDIO_READY,this.readyHandler,!1);d.setInstance(this.src,c);this.tag=null}SoundJS.playFinished(this)},interrupt:function(){if(null!=this.tag){this.playState=SoundJS.PLAY_INTERRUPTED;if(this.onPlayInterrupted)this.onPlayInterrupted(this);this.cleanUp();this.paused=!1}},play:function(a,b,d,e,g,f){this.cleanUp();SoundJS.playInstance(this,
a,b,d,e,g,f)},beginPlaying:function(c,b,f){var e=this.tag=d.getInstance(this.src);if(null==e)return this.playFailed(),-1;e.addEventListener(a.AUDIO_ENDED,this.endedHandler,!1);this.offset=c;this.volume=f;this.updateVolume();this.remainingLoops=b;4!==e.readyState?(e.addEventListener(a.AUDIO_READY,this.readyHandler,!1),e.addEventListener(a.AUDIO_STALLED,this.stalledHandler,!1),e.load()):this.handleSoundReady(null);return 1},handleSoundStalled:function(){if(null!=this.onPlayFailed)this.onPlayFailed(this);
this.cleanUp()},handleSoundReady:function(){this.playState=SoundJS.PLAY_SUCCEEDED;this.paused=!1;this.tag.removeEventListener(a.AUDIO_READY,this.readyHandler,!1);this.offset>=this.getDuration()?this.playFailed():(this.tag.currentTime=0.001*this.offset,this.tag.play())},pause:function(){this.paused=!0;return null!=this.tag?(this.tag.pause(),!1):!0},resume:function(){this.paused=!1;return null!=this.tag?(this.tag.play(),!1):!0},stop:function(){this.pause();this.playState=SoundJS.PLAY_FINISHED;this.cleanUp();
return!0},setMasterVolume:function(){this.updateVolume();return!0},setVolume:function(a){this.volume=a;this.updateVolume();return!0},updateVolume:function(){return null!=this.tag?(this.tag.volume=this.muted?0:this.volume*SoundJS.masterVolume,!0):!1},getVolume:function(){return this.volume},mute:function(a){this.muted=a;this.updateVolume();return!0},setPan:function(){return!1},getPan:function(){return 0},getPosition:function(){return null==this.tag?0:1E3*this.tag.currentTime},setPosition:function(a){if(null==
this.tag)return!1;try{this.tag.currentTime=0.001*a}catch(b){return!1}return!0},getDuration:function(){return null==this.tag?0:1E3*this.tag.duration},handleSoundComplete:function(){if(0!=this.remainingLoops){this.remainingLoops--;try{this.tag.currentTime=0}catch(a){}this.tag.play();if(null!=this.onLoop)this.onLoop(this)}else{this.playState=SoundJS.PLAY_FINISHED;if(null!=this.onComplete)this.onComplete(this);this.cleanUp()}},playFailed:function(){this.playState=SoundJS.PLAY_FAILED;if(null!=this.onPlayFailed)this.onPlayFailed(this);
this.cleanUp()},toString:function(){return"[HTMLAudio SoundInstance]"}};d.channels={};d.get=function(a){var b=d.channels[a];null==b&&(b=d.channels[a]=new d(a));return b};d.getInstance=function(a){a=d.channels[a];return null==a?null:a.get()};d.setInstance=function(a,b){var f=d.channels[a];return null==f?null:f.set(b)};d.prototype={src:null,length:0,available:0,tags:null,container:null,init:function(a){this.src=a;this.tags=[];this.container=document.createElement("div");this.container.style.width="0px";
this.container.style.height="0px";document.body.appendChild(this.container)},add:function(a){this.tags.push(a);this.length++;this.available=this.tags.length},get:function(){if(0==this.tags.length)return null;this.available=this.tags.length;var a=this.tags.pop();null==a.parentNode&&this.container.appendChild(a);return a},set:function(a){-1==this.tags.indexOf(a)&&this.tags.push(a);this.available=this.tags.length},toString:function(){return"[HTMLAudioPlugin TagChannel]"}}})(window);
(function(h){function a(){this.init()}function f(a,b){this.init(a,b)}function d(a,b,d,e){this.init(a,b,d,e)}a.capabilities=null;a.BASE_PATH="src/soundjs";a.lastId=0;a.preloadId=0;a.isSupported=function(){return SoundJS.BrowserDetect.isAdobeAIR&&SoundJS.BrowserDetect.isAndroid};a.generateCapabilities=function(){return null!=a.capabilities?a.capabilities:a.capabilities={panning:!0,volume:!0,mp3:!0,ogg:!0,mpeg:!0,wav:!0,channels:255}};a.prototype={CONTAINER_ID:"flashAudioContainer",capabilities:null,
container:null,externalContainer:null,flashReady:!1,externalPlayerSoundInstances:null,externalPlayerPreloadInstances:null,queuedInstances:null,init:function(){this.capabilities=a.generateCapabilities();this.externalPlayerSoundInstances={};this.externalPlayerPreloadInstances={};this.queuedInstances=[]},handleTimeout:function(){},register:function(c){var b="p"+a.preloadId++;return new d(c,this.externalContainer,this,b)},create:function(a){try{var b=new f(a,this.externalContainer);b.owner=this;return b}catch(d){}return null},
registerSoundInstance:function(a,b){this.externalPlayerSoundInstances[a]=b},unregisterSoundInstance:function(a){delete this.externalPlayerSoundInstances[a]},handleSoundEvent:function(a,b){var d=this.externalPlayerSoundInstances[a];if(null!=d){for(var e=[],f=2,h=arguments.length;f<h;f++)e.push(arguments[f]);try{if(0==e.length)d[b]();else d[b].apply(d,e)}catch(j){}}},handleEvent:function(){},handleErrorEvent:function(){},toString:function(){return"[ExternalPlugin]"}};h.SoundJS.ExternalPlugin=a;f.prototype=
{src:null,uniqueId:-1,capabilities:null,externalContainer:null,playerId:null,loop:0,volume:1,pan:0,muted:!1,paused:!1,onComplete:null,onLoop:null,onReady:null,onPlayFailed:null,onPlayInterrupted:null,init:function(a){this.playerId=h.soundJsExternalRegister(a);this.src=a;this.externalPlayer=h},initialize:function(a){this.externalContainer=a},interrupt:function(){this.playState=SoundJS.PLAY_INTERRUPTED;if(null!=this.onPlayInterrupted)this.onPlayInterrupted(this);this.cleanUp()},cleanUp:function(){this.owner.unregisterSoundInstance(this.playerId);
SoundJS.playFinished(this)},play:function(a,b,d,e,f,h,j){SoundJS.playInstance(this,a,b,d,e,f,h,j)},beginPlaying:function(a,b){this.loop=b;this.paused=!1;this.externalPlayer.soundJsExternalPlay(this.playerId);this.playState=SoundJS.PLAY_SUCCEEDED;this.owner.registerSoundInstance(this.playerId,this);return!0},pause:function(){this.paused=!0;this.externalPlayer.soundJsExternalPause(this.playerId)},resume:function(){this.paused=!1;this.externalPlayer.soundJsExternalResume(this.playerId)},stop:function(){this.playState=
SoundJS.PLAY_FINISHED;this.paused=!1;this.externalPlayer.soundJsExternalStop(this.playerId);this.cleanUp();return!0},setVolume:function(a){this.volume=a},getVolume:function(){return this.volume},mute:function(a){this.muted=a},getPan:function(){return this.pan},setPan:function(a){this.pan=a},getPosition:function(){return 0},setPosition:function(){},getDuration:function(){},handleSoundFinished:function(){this.playState=SoundJS.PLAY_FINISHED;if(null!=this.onComplete)this.onComplete(this);this.cleanUp()},
handleLoop:function(){if(null!=this.onLoop)this.onLoop(this)},toString:function(){return"[ExternalPlugin SoundInstance]"}};d.prototype={externalContainer:null,src:null,tag:null,playerId:null,progress:1,readyState:4,loading:!1,preloadId:null,owner:null,onload:null,onprogress:null,onError:null,init:function(a,b,d,e){this.src=a;this.externalContainer=b;this.owner=d;this.preloadId=e;this.tag=this},initialize:function(){},load:function(){return!1},handleProgress:function(a,b){this.progress=a/b;if(null!=
this.onprogress)this.onprogress({loaded:a,total:b,progress:this.progress})},handleComplete:function(){this.progress=1;this.readyState=4;if(null!=this.onload)this.onload()},handleError:function(a){if(null!=this.onerror)this.onerror(a)},toString:function(){return"[ExternalPlugin SoundLoader]"}}})(window);
